(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     26393,        845]
NotebookOptionsPosition[     23218,        734]
NotebookOutlinePosition[     23556,        749]
CellTagsIndexPosition[     23513,        746]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Scratch work when deriving some maximum entropy priors", "Title",
 CellChangeTimes->{{3.536279157730492*^9, 3.536279166527672*^9}}],

Cell["Eric Moyer", "Subtitle",
 CellChangeTimes->{{3.536279169250355*^9, 3.5362791705596123`*^9}}],

Cell["22 Jan 2012", "Subsubtitle",
 CellChangeTimes->{{3.5362791745304747`*^9, 3.536279177464113*^9}}],

Cell[CellGroupData[{

Cell["Known Median and Positive Variable", "Section",
 CellChangeTimes->{{3.5362792007276707`*^9, 3.536279225038601*^9}}],

Cell[TextData[{
 "Using the constraints that the median is \[Mu] (I know, it looks like a \
mean, but this is easier to type than ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", 
    FractionBox["1", "2"]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ") and the variable is positive (so p(x)=0 if x < 0), I generated a function \
with Lagrange multipliers to find the maximum entropy distribution p.  I got \
that p must have the form:"
}], "Text",
 CellChangeTimes->{{3.536279226573464*^9, 3.536279292965412*^9}, {
  3.536279342420542*^9, 3.536279387617876*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "[", "x_", "]"}], ":=", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"\[Lambda]0", "+", "\[Lambda]1", "-", "1"}]]}]], "Input",
 CellChangeTimes->{{3.5362791871978893`*^9, 3.5362791921127033`*^9}, {
  3.536279336898666*^9, 3.5362793398399343`*^9}, {3.536279391485744*^9, 
  3.536279425109351*^9}}],

Cell["\<\
This is not looking good so far.  x is not involved.  x has to pop in when we \
solve the constraints.\
\>", "Text",
 CellChangeTimes->{{3.536279433226244*^9, 3.5362794341014338`*^9}, {
  3.536279524695695*^9, 3.53627959168762*^9}}],

Cell[CellGroupData[{

Cell["First Constraint", "Subsection",
 CellChangeTimes->{{3.536279712371746*^9, 3.536279716391013*^9}}],

Cell["\<\
The first constraint is that the area before the median must be 1/2.  First \
get the expression for the area before the median.\
\>", "Text",
 CellChangeTimes->{{3.5362797297632427`*^9, 3.5362797497848883`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"p", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "\[Mu]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5362796084620113`*^9, 3.536279618348934*^9}}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "\[Lambda]0", "+", "\[Lambda]1"}]], " ", 
  "\[Mu]"}]], "Output",
 CellChangeTimes->{3.536279619065648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Lambda]0", "+", "\[Lambda]1"}]], " ", 
      "\[Mu]"}], "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], "&&", 
    RowBox[{"\[Lambda]0", ">=", "0"}]}], ",", "\[Lambda]0", ",", "Reals"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.536279708104991*^9, 3.536279723952669*^9}, {
  3.536279764422225*^9, 3.536279800232677*^9}, {3.536279898736713*^9, 
  3.5362799003269567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]", ">", "0"}], "&&", 
  RowBox[{"\[Lambda]1", "\[LessEqual]", 
   RowBox[{"1", "+", 
    RowBox[{"Log", "[", 
     FractionBox["1", 
      RowBox[{"2", " ", "\[Mu]"}]], "]"}]}]}], "&&", 
  RowBox[{"\[Lambda]0", "\[Equal]", 
   RowBox[{"1", "-", "\[Lambda]1", "+", 
    RowBox[{"Log", "[", 
     FractionBox["1", 
      RowBox[{"2", " ", "\[Mu]"}]], "]"}]}]}]}]], "Output",
 CellChangeTimes->{{3.536279773062263*^9, 3.536279801419145*^9}, 
   3.536279901409738*^9}]
}, Open  ]],

Cell["\<\
When we substitute this back in, we get a constant expression.\
\>", "Text",
 CellChangeTimes->{{3.536280191046783*^9, 3.536280196188706*^9}, {
  3.536280316281389*^9, 3.536280335760353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "=", 
     RowBox[{"1", "-", "\[Lambda]1", "+", 
      RowBox[{"Log", "[", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"2", "\[Mu]"}], ")"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"p", "[", "x", "]"}], "/.", 
    RowBox[{"\[Lambda]0", "\[Rule]", "\[Lambda]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.536280201072646*^9, 3.536280307136994*^9}}],

Cell[BoxData[
 FractionBox["1", 
  RowBox[{"2", " ", "\[Mu]"}]]], "Output",
 CellChangeTimes->{3.536280223362323*^9, 3.536280258579418*^9, 
  3.536280307776845*^9}]
}, Open  ]],

Cell["\<\
There is now no way to get a solution that also satisfies the second \
constraint. We are out of variables. Time to give up and go home.\
\>", "Text",
 CellChangeTimes->{{3.536280339671218*^9, 3.536280377023963*^9}}],

Cell["\<\
There is not enough information in these constraints to uniquely define a \
distribution.\
\>", "Text",
 CellChangeTimes->{{3.536280379262212*^9, 3.536280393100896*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Value greater than n and mean=\[Mu]\
\>", "Section",
 CellChangeTimes->{{3.536285131394774*^9, 3.536285139113599*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"x", " ", "\[Lambda]1"}]], "\[Lambda]1"], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "n", ",", "Infinity"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"\[Lambda]1", "<", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.536285146089012*^9, 3.536285232169346*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"n", " ", "\[Lambda]1"}]], 
   SuperscriptBox["\[Lambda]1", "2"]]}]], "Output",
 CellChangeTimes->{3.53628519927986*^9, 3.536285233876975*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"x", " ", "\[Lambda]1"}]], "\[Lambda]1"], ",", "x", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"\[Lambda]1", "<", "0"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.536285146089012*^9, 3.5362852581868677`*^9}}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"x", " ", "\[Lambda]1"}]], 
  SuperscriptBox["\[Lambda]1", "2"]]], "Output",
 CellChangeTimes->{3.5362852588432617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"n", " ", "\[Lambda]1"}]], 
       SuperscriptBox["\[Lambda]1", "2"]]}], "\[Equal]", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "\[Mu]"}], " ", 
       SuperscriptBox["\[ExponentialE]", "n"]}], 
      RowBox[{"s", " ", "\[Lambda]1"}]]}], "&&", 
    RowBox[{"\[Lambda]1", "<", "0"}], "&&", 
    RowBox[{"0", "<", "s", "\[LessEqual]", "1"}], "&&", 
    RowBox[{"n", "<", "\[Mu]"}]}], ",", "\[Lambda]1", ",", "Reals"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.536285623287045*^9, 3.536285686767078*^9}, {
  3.53628583527289*^9, 3.536285852017671*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "::", "\<\"nsmet\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"This system cannot be solved \
with the methods available to Reduce.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Reduce\\\", ButtonNote -> \
\\\"Reduce::nsmet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.536285918457535*^9}],

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"n", " ", "\[Lambda]1"}]], 
       SuperscriptBox["\[Lambda]1", "2"]]}], "\[Equal]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", "n"], " ", "\[Mu]"}], 
       RowBox[{"s", " ", "\[Lambda]1"}]]}]}], "&&", 
    RowBox[{"\[Lambda]1", "<", "0"}], "&&", 
    RowBox[{"0", "<", "s", "\[LessEqual]", "1"}], "&&", 
    RowBox[{"n", "<", "\[Mu]"}]}], ",", "\[Lambda]1", ",", "Reals"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.536285918942069*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"n", " ", "\[Lambda]1"}]], 
      SuperscriptBox["\[Lambda]1", "2"]]}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "\[Mu]"}], " ", 
      SuperscriptBox["\[ExponentialE]", "n"]}], 
     RowBox[{"s", " ", "\[Lambda]1"}]]}], ",", "\[Lambda]1"}], "]"}]], "Input",\

 CellChangeTimes->{{3.536285811725122*^9, 3.536285825890266*^9}, {
  3.536285938820901*^9, 3.536285953287292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"InverseFunction", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used. Values may be lost for multivalued inverses.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/InverseFunction/ifun\\\", ButtonNote -> \\\
\"InverseFunction::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.536285954997367*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Solve", "::", "\<\"ifun\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Inverse functions are being \
used by \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Solve\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", so some solutions may not be found; \
use Reduce for complete solution information.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\
\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/ifun\\\", \
ButtonNote -> \\\"Solve::ifun\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5362859552599382`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Lambda]1", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"ProductLog", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}], 
      "n"]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.536285955381098*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{"s", " ", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"-", "\[Lambda]1"}], "]"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "-", "n"}], ")"}], "\[Lambda]1"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.536286458565514*^9, 3.5362865064709063`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "n"}], "+", "x"}], ")"}], " ", "\[Lambda]1"}]]}], " ", 
  "s", " ", "\[Lambda]1"}]], "Output",
 CellChangeTimes->{3.536286507010722*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]1", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"ProductLog", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}], 
       "n"]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.536286519251123*^9, 3.536286544383131*^9}, {
  3.536286593231975*^9, 3.5362866470225286`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "n"}], "-", 
      FractionBox[
       RowBox[{"x", " ", 
        RowBox[{"ProductLog", "[", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}]}], 
       "n"]}]], " ", 
    SuperscriptBox["s", "2"]}], "\[Mu]"]}]], "Output",
 CellChangeTimes->{{3.5362866224421177`*^9, 3.5362866477629757`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"p", "[", "x_", "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "n"}], "-", 
       FractionBox[
        RowBox[{"x", " ", 
         RowBox[{"ProductLog", "[", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}]}], 
        "n"]}]], " ", 
     SuperscriptBox["s", "2"]}], "\[Mu]"]}]}]], "Input",
 CellChangeTimes->{{3.536286624326098*^9, 3.536286637599823*^9}}],

Cell["\<\
Here I check that the first constraint holds: that the integral is s:\
\>", "Text",
 CellChangeTimes->{{3.536288332780491*^9, 3.536288357323958*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   RowBox[{"p", "[", "x", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "n", ",", "Infinity"}], "}"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{
     RowBox[{"n", "<", "\[Mu]"}], "&&", 
     RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.536286658589017*^9, 3.5362866743971863`*^9}, {
  3.536286721112399*^9, 3.53628677648477*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", "\[Mu]"], 
   RowBox[{
    SuperscriptBox["s", "2"], " ", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox[
         RowBox[{"ProductLog", "[", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}], 
         "n"], "]"}], ">", "0"}], ",", 
      RowBox[{"-", 
       FractionBox["\[Mu]", "s"]}], ",", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "n"}], "-", 
          FractionBox[
           RowBox[{"x", " ", 
            RowBox[{"ProductLog", "[", 
             RowBox[{"-", 
              FractionBox[
               RowBox[{
                SuperscriptBox["\[ExponentialE]", 
                 RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], 
             "]"}]}], "n"]}]], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "n", ",", "\[Infinity]"}], "}"}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{
          RowBox[{"\[Mu]", "\[Element]", "Reals"}], "&&", 
          RowBox[{"0", "<", "s", "\[LessEqual]", "1"}], "&&", 
          RowBox[{"n", "<", "\[Mu]"}], "&&", 
          RowBox[{
           RowBox[{"Re", "[", 
            FractionBox[
             RowBox[{"ProductLog", "[", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{
                 SuperscriptBox["\[ExponentialE]", 
                  RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], 
              "]"}], "n"], "]"}], "\[LessEqual]", "0"}]}]}]}], "]"}]}], 
     "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.536286675019557*^9, 3.5362867269952583`*^9, 
  3.536286792242334*^9}]
}, Open  ]],

Cell["\<\
The above integral shows that we are ok if productlog/n > 0.  However \
deriving the conditions for this takes a long time\
\>", "Text",
 CellChangeTimes->{{3.536288302461734*^9, 3.5362883286848927`*^9}, {
  3.536288386586043*^9, 3.536288401418746*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{"ProductLog", "[", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], "]"}], "n"], 
    ">", "0"}], "&&", 
   RowBox[{"n", "<", "\[Mu]"}], "&&", 
   RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.5362868032519417`*^9, 3.536286816796976*^9}, {
  3.53628687304178*^9, 3.536286881384129*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.5362868701700163`*^9, 3.536287203319111*^9}]
}, Open  ]],

Cell["\<\
ProductLog is real as long as its argument is greater than \
-1/\[ExponentialE].  Here I show the conditions are always met for a real \
ProductLog given that n<\[Mu] and 0<s\[LessEqual]1\
\>", "Text",
 CellChangeTimes->{{3.5362879854753*^9, 3.536288026890718*^9}, {
  3.536288060308509*^9, 3.536288086518957*^9}, {3.536288123566222*^9, 
  3.536288153191058*^9}}],

Cell["First, the general conditions for real ProductLog", "Text",
 CellChangeTimes->{{3.536288160122604*^9, 3.536288177963019*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], ">", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "E"}]}], "&&", 
    RowBox[{"n", "<", "0"}], "&&", 
    RowBox[{"n", "<", "\[Mu]"}], "&&", 
    RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "\[Mu]", ",", "s"}], "}"}], ",", "Reals"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.536287487493382*^9, 3.5362875585906277`*^9}, {
  3.536287589032022*^9, 3.536287590626684*^9}, {3.536288029928752*^9, 
  3.536288035673058*^9}, {3.536288099900073*^9, 3.536288113428873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "<", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"n", "<", "\[Mu]", "<", "0"}], "&&", 
      RowBox[{"0", "<", "s", "<", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}]], " ", "\[Mu]"}], "n"]}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Mu]", ">", "0"}], "&&", 
      RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.5362874993196783`*^9, 3.5362875270463552`*^9}, 
   3.536287559803039*^9, 3.536287591330542*^9, 3.5362880363006268`*^9, {
   3.536288101299539*^9, 3.5362881138869123`*^9}}]
}, Open  ]],

Cell["\<\
Now, show that the general conditions imply that s\[LessEqual]1 in either of \
the two branches of the or\
\>", "Text",
 CellChangeTimes->{{3.536288180786791*^9, 3.5362881878388453`*^9}, {
  3.536288222561961*^9, 3.536288250055167*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "n"}]], " ", "\[Mu]"}], "n"], 
     "\[LessEqual]", "1"}], "&&", 
    RowBox[{"n", "<", "\[Mu]", "<", "0"}]}], ",", "\[Mu]", ",", "Reals"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.536287685589952*^9, 3.536287720858623*^9}, {
  3.5362878009732313`*^9, 3.53628781938159*^9}, {3.536287916525079*^9, 
  3.536287921217856*^9}, {3.5362881986466513`*^9, 3.5362882162744093`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "<", "0"}], "&&", 
  RowBox[{"n", "<", "\[Mu]", "<", "0"}]}]], "Output",
 CellChangeTimes->{3.536287696498461*^9, 3.5362877273477373`*^9, 
  3.536287821261101*^9, 3.536287922251061*^9, 3.536288217376965*^9}]
}, Open  ]],

Cell["\<\
So, our assumptions imply ProductLog is real.  Now, we just need to see when \
ProductLog[ourExpression]/n >0\
\>", "Text",
 CellChangeTimes->{{3.536288412504941*^9, 3.5362884614236107`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"ProductLog", "[", "r", "]"}], ">", "0"}], ",", "r", ",", 
   "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.536288483863426*^9, 3.5362885009212418`*^9}}],

Cell[BoxData[
 RowBox[{"r", ">", "0"}]], "Output",
 CellChangeTimes->{3.536288501461927*^9}]
}, Open  ]],

Cell["\<\
So, when is the inside positive?  Break it into two cases, for n positive and \
n negative.  When n is negative, we'll want to find when the inside is less \
than 0\
\>", "Text",
 CellChangeTimes->{{3.536288563212789*^9, 3.536288587665881*^9}, {
  3.536288621305895*^9, 3.536288631936893*^9}}],

Cell["\<\
When n is positive, no luck.  This is not good for us (we can't have a \
minimum greater than 0.)\
\>", "Text",
 CellChangeTimes->{{3.5362887160536537`*^9, 3.5362887747375917`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], ">", "0"}], "&&", 
    RowBox[{"n", ">", "0"}], "&&", 
    RowBox[{"n", "<", "\[Mu]"}], "&&", 
    RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "s"}], "}"}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.536288639051998*^9, 3.536288702632421*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.536288640443426*^9, 3.5362887032831182`*^9}}]
}, Open  ]],

Cell["\<\
When n is negative, we can have any positive mean.  When n is 0 we reduce to \
the exponential distribution which can also have any positive mean.\
\>", "Text",
 CellChangeTimes->{{3.536288788827599*^9, 3.536288854670835*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", "n"}]], " ", "n", " ", "s"}], "\[Mu]"]}], ">", "0"}], "&&", 
    RowBox[{"n", "<", "0"}], "&&", 
    RowBox[{"n", "<", "\[Mu]"}], "&&", 
    RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "s"}], "}"}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.536288639051998*^9, 3.536288702632421*^9}, {
  3.5362888037954397`*^9, 3.536288804213374*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Mu]", ">", "0"}], "&&", 
  RowBox[{"n", "<", "0"}], "&&", 
  RowBox[{"0", "<", "s", "\[LessEqual]", "1"}]}]], "Output",
 CellChangeTimes->{3.536288811072957*^9}]
}, Open  ]],

Cell["\<\
Why is negative n problematic?  Because the mean is the product of x and \
p(x).  When x is negative, that includes negative numbers in the sum and \
maybe messes up the scaling?\
\>", "Text",
 CellChangeTimes->{{3.5362888927905617`*^9, 3.5362889279566393`*^9}, {
  3.536288958667598*^9, 3.53628897356279*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{640, 655},
WindowMargins->{{144, Automatic}, {Automatic, 27}},
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 137, 1, 197, "Title"],
Cell[707, 25, 98, 1, 53, "Subtitle"],
Cell[808, 28, 102, 1, 32, "Subsubtitle"],
Cell[CellGroupData[{
Cell[935, 33, 121, 1, 73, "Section"],
Cell[1059, 36, 579, 13, 107, "Text"],
Cell[1641, 51, 339, 7, 34, "Input"],
Cell[1983, 60, 242, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[2250, 69, 104, 1, 39, "Subsection"],
Cell[2357, 72, 222, 4, 55, "Text"],
Cell[CellGroupData[{
Cell[2604, 80, 245, 6, 34, "Input"],
Cell[2852, 88, 209, 6, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3098, 99, 551, 15, 34, "Input"],
Cell[3652, 116, 504, 14, 49, "Output"]
}, Open  ]],
Cell[4171, 133, 201, 4, 33, "Text"],
Cell[CellGroupData[{
Cell[4397, 141, 471, 13, 34, "Input"],
Cell[4871, 156, 164, 4, 49, "Output"]
}, Open  ]],
Cell[5050, 163, 226, 4, 55, "Text"],
Cell[5279, 169, 179, 4, 55, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[5507, 179, 128, 3, 73, "Section"],
Cell[CellGroupData[{
Cell[5660, 186, 407, 10, 59, "Input"],
Cell[6070, 198, 236, 6, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6343, 209, 343, 8, 59, "Input"],
Cell[6689, 219, 196, 5, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6922, 229, 732, 20, 88, "Input"],
Cell[7657, 251, 471, 9, 45, "Message"],
Cell[8131, 262, 663, 19, 76, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8831, 286, 550, 16, 61, "Input"],
Cell[9384, 304, 523, 10, 65, "Message"],
Cell[9910, 316, 666, 12, 65, "Message"],
Cell[10579, 330, 413, 13, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11029, 348, 348, 10, 34, "Input"],
Cell[11380, 360, 281, 9, 34, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11698, 374, 541, 15, 68, "Input"],
Cell[12242, 391, 559, 17, 71, "Output"]
}, Open  ]],
Cell[12816, 411, 622, 19, 81, "Input"],
Cell[13441, 432, 159, 3, 33, "Text"],
Cell[CellGroupData[{
Cell[13625, 439, 449, 11, 59, "Input"],
Cell[14077, 452, 1864, 53, 183, "Output"]
}, Open  ]],
Cell[15956, 508, 263, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[16244, 517, 537, 15, 68, "Input"],
Cell[16784, 534, 101, 1, 34, "Output"]
}, Open  ]],
Cell[16900, 538, 373, 7, 77, "Text"],
Cell[17276, 547, 131, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[17432, 552, 751, 20, 86, "Input"],
Cell[18186, 574, 743, 21, 50, "Output"]
}, Open  ]],
Cell[18944, 598, 246, 5, 55, "Text"],
Cell[CellGroupData[{
Cell[19215, 607, 576, 15, 59, "Input"],
Cell[19794, 624, 246, 5, 34, "Output"]
}, Open  ]],
Cell[20055, 632, 201, 4, 55, "Text"],
Cell[CellGroupData[{
Cell[20281, 640, 231, 6, 34, "Input"],
Cell[20515, 648, 92, 2, 34, "Output"]
}, Open  ]],
Cell[20622, 653, 303, 6, 55, "Text"],
Cell[20928, 661, 191, 4, 55, "Text"],
Cell[CellGroupData[{
Cell[21144, 669, 540, 15, 86, "Input"],
Cell[21687, 686, 100, 1, 34, "Output"]
}, Open  ]],
Cell[21802, 690, 236, 4, 55, "Text"],
Cell[CellGroupData[{
Cell[22063, 698, 591, 16, 86, "Input"],
Cell[22657, 716, 198, 5, 34, "Output"]
}, Open  ]],
Cell[22870, 724, 320, 6, 77, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
