import ["c/dependencies","autoclean"]
gen C::Dependencies
$cpp="g++"
$warn="-Wall -Wextra -Weffc++"
$executables = ["hough_sample_params", "simple_hough","assign_peaks"]

desc "Compile all executables"
task :default => $executables

$executables.each do | execName |
  desc "Compile #{execName}"
  file "#{execName}" => execName+".o" do |t|
    sys "#{$cpp} -o  #{t.name} #{sys.sp t.prerequisites}"
  end
end

# Do c/c++ dependency checking
gen Action do source "c_dependencies" end

#.o file rules - compile .c and .cpp with C++ compiler
gen Rule, :o => :cpp do |t|
  sys "#{$cpp} #{$warn} -c -o #{t.name} #{t.source}"
end
gen Rule, :o => :c do |t|
  sys "#{$cpp} #{$warn} -c -o #{t.name} #{t.source}"
end

# Clean up
desc "Remove all generated files"
gen AutoClean, :clean
